# 08-14 笔记

## 1. 串口通讯基础

### 概念
- **串口通信**（Serial Communication）：数据按位依次传输，对比并口的多位同时传输。
- 优点：连线少、成本低、抗干扰强。
- 常见标准：
  - **RS-232**
  - **RS-485**
- 异步传输：发送端与接收端需预先约定参数（波特率、数据位、停止位、校验位）。
- 数据以 **帧** 为单位传输：起始位 → 数据位 → 可选校验位 → 停止位。

### 数据方向
- **单工**：单向传输
- **半双工**：双向但不能同时
- **全双工**：双向同时传输

### 同步与异步
- 同步：有时钟线同步（如 SPI、I2C）
- 异步：无时钟线（如 UART）

---

## 2. STM32 串口通信

### UART & USART
- **UART**（通用异步收发器）：最基本的串口通信接口，只需 TXD（发送）、RXD（接收）、VCC、GND。
- **USART**（通用同步/异步收发器）：功能更丰富，可同步传输（需要 CLK 时钟线）。

### 硬件连接
- GND 共地
- TXD ↔ RXD 交叉连接（TTL 电平通信）

---

## 3. UART 通信协议配置

1. **起始位**：空闲时为逻辑 1，传输开始为逻辑 0
2. **数据位**：常用 8 位或 9 位
3. **奇偶校验位**：可选，用于错误检测
4. **停止位**：1 位 / 1.5 位 / 2 位，停止位越多速率越慢

### 波特率
- 常用：115200 / 9600
- 单位：Baud（码元/秒）
- 比特率：bit/s（位/秒）

---

## 4. STM32 串口相关寄存器

- **CR1**：控制数据位长度、奇偶校验、中断使能等
- **CR2**：停止位、时钟控制、LIN 模式
- **CR3**：硬件流控制、DMA、错误中断
- **SR**：状态寄存器，显示传输状态与错误标志
- **DR**：数据寄存器
- **BRR**：波特率分频值

---

## 5. STM32 串口通信三种模式

1. **轮询模式**：CPU 主动查询数据寄存器（简单但占用 CPU）
2. **中断模式（IT）**：通过中断接收/发送，减少 CPU 占用
3. **DMA 模式**：通过 DMA 自动搬运数据，适合大数据量传输

---

## 7. DMA

### 概念
- DMA（Direct Memory Access）：在外设与存储器、存储器与存储器之间进行高速数据传输，无需 CPU 参与。
- 优势：减轻 CPU 负担，尤其是大数据量传输。

### 常见传输方式
1. 外设 → 内存
2. 内存 → 外设
3. 内存 → 内存
4. 外设 → 外设

### STM32 串口 DMA 配合
- 配置可通过 CubeMX 完成
- 用于大数据量串口收发，效率高

